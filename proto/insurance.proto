syntax = "proto3";

package insurance;
option go_package = "lazervaultGo/pb";

import "google/api/annotations.proto";

// Inline pagination to avoid cross-proto package dependency
message InsurancePaginationInfo {
    int32 current_page = 1;
    int32 total_pages = 2;
    int32 total_items = 3;
    int32 items_per_page = 4;
    bool has_next = 5;
    bool has_prev = 6;
}

// Insurance Policy Management
message GetUserInsurancesRequest {
    int32 page = 1;
    int32 limit = 2;
}

message GetUserInsurancesResponse {
    repeated Insurance insurances = 1;
    InsurancePaginationInfo pagination = 2;
    bool success = 3;
    string msg = 4;
}

message GetInsuranceByIdRequest {
    string id = 1;
}

message GetInsuranceByIdResponse {
    Insurance insurance = 1;
    bool success = 2;
    string msg = 3;
}

message CreateInsuranceRequest {
    Insurance insurance = 1;
}

message CreateInsuranceResponse {
    Insurance insurance = 1;
    bool success = 2;
    string msg = 3;
}

message UpdateInsuranceRequest {
    Insurance insurance = 1;
}

message UpdateInsuranceResponse {
    Insurance insurance = 1;
    bool success = 2;
    string msg = 3;
}

message DeleteInsuranceRequest {
    string id = 1;
}

message DeleteInsuranceResponse {
    bool success = 1;
    string msg = 2;
}

message SearchInsurancesRequest {
    string query = 1;
    int32 page = 2;
    int32 limit = 3;
}

message SearchInsurancesResponse {
    repeated Insurance insurances = 1;
    InsurancePaginationInfo pagination = 2;
    bool success = 3;
    string msg = 4;
}

// Payment Management
message GetInsurancePaymentsRequest {
    string insurance_id = 1;
    int32 page = 2;
    int32 limit = 3;
}

message GetInsurancePaymentsResponse {
    repeated InsurancePayment payments = 1;
    InsurancePaginationInfo pagination = 2;
    bool success = 3;
    string msg = 4;
}

message GetUserPaymentsRequest {
    int32 page = 1;
    int32 limit = 2;
}

message GetUserPaymentsResponse {
    repeated InsurancePayment payments = 1;
    InsurancePaginationInfo pagination = 2;
    bool success = 3;
    string msg = 4;
}

message CreatePaymentRequest {
    InsurancePayment payment = 1;
}

message CreatePaymentResponse {
    InsurancePayment payment = 1;
    bool success = 2;
    string msg = 3;
}

message ProcessPaymentRequest {
    string payment_id = 1;
    string payment_method = 2;
    map<string, string> payment_details = 3;
}

message ProcessPaymentResponse {
    InsurancePayment payment = 1;
    string transaction_id = 2;
    string reference_number = 3;
    string receipt_url = 4;
    bool success = 5;
    string msg = 6;
}

message GetPaymentByIdRequest {
    string id = 1;
}

message GetPaymentByIdResponse {
    InsurancePayment payment = 1;
    bool success = 2;
    string msg = 3;
}

message GetOverduePaymentsRequest {}

message GetOverduePaymentsResponse {
    repeated InsurancePayment payments = 1;
    bool success = 2;
    string msg = 3;
}

// Claims Management
message GetInsuranceClaimsRequest {
    string insurance_id = 1;
    int32 page = 2;
    int32 limit = 3;
}

message GetInsuranceClaimsResponse {
    repeated InsuranceClaim claims = 1;
    InsurancePaginationInfo pagination = 2;
    bool success = 3;
    string msg = 4;
}

message GetUserClaimsRequest {
    int32 page = 1;
    int32 limit = 2;
}

message GetUserClaimsResponse {
    repeated InsuranceClaim claims = 1;
    InsurancePaginationInfo pagination = 2;
    bool success = 3;
    string msg = 4;
}

message CreateClaimRequest {
    InsuranceClaim claim = 1;
}

message CreateClaimResponse {
    InsuranceClaim claim = 1;
    bool success = 2;
    string msg = 3;
}

message UpdateClaimRequest {
    InsuranceClaim claim = 1;
}

message UpdateClaimResponse {
    InsuranceClaim claim = 1;
    bool success = 2;
    string msg = 3;
}

message GetClaimByIdRequest {
    string id = 1;
}

message GetClaimByIdResponse {
    InsuranceClaim claim = 1;
    bool success = 2;
    string msg = 3;
}

// Receipt Management
message GeneratePaymentReceiptRequest {
    string payment_id = 1;
}

message GeneratePaymentReceiptResponse {
    string receipt_url = 1;
    string receipt_id = 2;
    bool success = 3;
    string msg = 4;
}

message GetUserReceiptsRequest {
    int32 page = 1;
    int32 limit = 2;
}

message GetUserReceiptsResponse {
    repeated string receipt_urls = 1;
    InsurancePaginationInfo pagination = 2;
    bool success = 3;
    string msg = 4;
}

// Statistics
message GetInsuranceStatisticsRequest {}

message GetInsuranceStatisticsResponse {
    int32 total_policies = 1;
    int32 active_policies = 2;
    int32 expired_policies = 3;
    double total_coverage_amount = 4;
    double total_premium_amount = 5;
    map<string, int32> policies_by_type = 6;
    bool success = 7;
    string msg = 8;
}

message GetPaymentStatisticsRequest {
    string start_date = 1;
    string end_date = 2;
}

message GetPaymentStatisticsResponse {
    int32 total_payments = 1;
    int32 completed_payments = 2;
    int32 pending_payments = 3;
    int32 failed_payments = 4;
    double total_amount = 5;
    double completed_amount = 6;
    map<string, int32> payments_by_method = 7;
    bool success = 8;
    string msg = 9;
}

// Data Models
message Insurance {
    string id = 1;
    string policy_number = 2;
    string policy_holder_name = 3;
    string policy_holder_email = 4;
    string policy_holder_phone = 5;
    string type = 6;
    string provider = 7;
    string provider_logo = 8;
    double premium_amount = 9;
    double coverage_amount = 10;
    string currency = 11;
    string start_date = 12;
    string end_date = 13;
    string next_payment_date = 14;
    string status = 15;
    repeated string beneficiaries = 16;
    map<string, string> coverage_details = 17;
    string description = 18;
    string user_id = 19;
    string created_at = 20;
    string updated_at = 21;
}

message InsurancePayment {
    string id = 1;
    string insurance_id = 2;
    string policy_number = 3;
    double amount = 4;
    string currency = 5;
    string payment_method = 6;
    string status = 7;
    string transaction_id = 8;
    string reference_number = 9;
    string payment_date = 10;
    string due_date = 11;
    string processed_at = 12;
    map<string, string> payment_details = 13;
    string failure_reason = 14;
    string receipt_url = 15;
    string user_id = 16;
    string created_at = 17;
    string updated_at = 18;
}

message InsuranceClaim {
    string id = 1;
    string claim_number = 2;
    string insurance_id = 3;
    string policy_number = 4;
    string type = 5;
    string status = 6;
    string title = 7;
    string description = 8;
    double claim_amount = 9;
    double approved_amount = 10;
    string currency = 11;
    string incident_date = 12;
    string incident_location = 13;
    repeated string attachments = 14;
    repeated string documents = 15;
    map<string, string> additional_info = 16;
    string rejection_reason = 17;
    string settlement_date = 18;
    string settlement_details = 19;
    string user_id = 20;
    string created_at = 21;
    string updated_at = 22;
}

// Service Definition
service InsuranceService {
    // Insurance Policy Management
    rpc GetUserInsurances(GetUserInsurancesRequest) returns (GetUserInsurancesResponse) {
        option (google.api.http) = {
            get: "/v1/insurance"
        };
    }

    rpc GetInsuranceById(GetInsuranceByIdRequest) returns (GetInsuranceByIdResponse) {
        option (google.api.http) = {
            get: "/v1/insurance/{id}"
        };
    }

    rpc CreateInsurance(CreateInsuranceRequest) returns (CreateInsuranceResponse) {
        option (google.api.http) = {
            post: "/v1/insurance"
            body: "*"
        };
    }

    rpc UpdateInsurance(UpdateInsuranceRequest) returns (UpdateInsuranceResponse) {
        option (google.api.http) = {
            put: "/v1/insurance"
            body: "*"
        };
    }

    rpc DeleteInsurance(DeleteInsuranceRequest) returns (DeleteInsuranceResponse) {
        option (google.api.http) = {
            delete: "/v1/insurance/{id}"
        };
    }

    rpc SearchInsurances(SearchInsurancesRequest) returns (SearchInsurancesResponse) {
        option (google.api.http) = {
            get: "/v1/insurance/search"
        };
    }

    // Payment Management
    rpc GetInsurancePayments(GetInsurancePaymentsRequest) returns (GetInsurancePaymentsResponse) {
        option (google.api.http) = {
            get: "/v1/insurance/{insurance_id}/payments"
        };
    }

    rpc GetUserPayments(GetUserPaymentsRequest) returns (GetUserPaymentsResponse) {
        option (google.api.http) = {
            get: "/v1/insurance/payments"
        };
    }

    rpc CreatePayment(CreatePaymentRequest) returns (CreatePaymentResponse) {
        option (google.api.http) = {
            post: "/v1/insurance/payments"
            body: "*"
        };
    }

    rpc ProcessPayment(ProcessPaymentRequest) returns (ProcessPaymentResponse) {
        option (google.api.http) = {
            post: "/v1/insurance/payments/{payment_id}/process"
            body: "*"
        };
    }

    rpc GetPaymentById(GetPaymentByIdRequest) returns (GetPaymentByIdResponse) {
        option (google.api.http) = {
            get: "/v1/insurance/payments/{id}"
        };
    }

    rpc GetOverduePayments(GetOverduePaymentsRequest) returns (GetOverduePaymentsResponse) {
        option (google.api.http) = {
            get: "/v1/insurance/payments/overdue"
        };
    }

    // Claims Management
    rpc GetInsuranceClaims(GetInsuranceClaimsRequest) returns (GetInsuranceClaimsResponse) {
        option (google.api.http) = {
            get: "/v1/insurance/{insurance_id}/claims"
        };
    }

    rpc GetUserClaims(GetUserClaimsRequest) returns (GetUserClaimsResponse) {
        option (google.api.http) = {
            get: "/v1/insurance/claims"
        };
    }

    rpc CreateClaim(CreateClaimRequest) returns (CreateClaimResponse) {
        option (google.api.http) = {
            post: "/v1/insurance/claims"
            body: "*"
        };
    }

    rpc UpdateClaim(UpdateClaimRequest) returns (UpdateClaimResponse) {
        option (google.api.http) = {
            put: "/v1/insurance/claims"
            body: "*"
        };
    }

    rpc GetClaimById(GetClaimByIdRequest) returns (GetClaimByIdResponse) {
        option (google.api.http) = {
            get: "/v1/insurance/claims/{id}"
        };
    }

    // Receipt Management
    rpc GeneratePaymentReceipt(GeneratePaymentReceiptRequest) returns (GeneratePaymentReceiptResponse) {
        option (google.api.http) = {
            post: "/v1/insurance/payments/{payment_id}/receipt"
        };
    }

    rpc GetUserReceipts(GetUserReceiptsRequest) returns (GetUserReceiptsResponse) {
        option (google.api.http) = {
            get: "/v1/insurance/receipts"
        };
    }

    // Statistics
    rpc GetInsuranceStatistics(GetInsuranceStatisticsRequest) returns (GetInsuranceStatisticsResponse) {
        option (google.api.http) = {
            get: "/v1/insurance/statistics"
        };
    }

    rpc GetPaymentStatistics(GetPaymentStatisticsRequest) returns (GetPaymentStatisticsResponse) {
        option (google.api.http) = {
            get: "/v1/insurance/payments/statistics"
        };
    }
}
